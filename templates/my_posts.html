{% load static %}
<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mening Postlarim - devSphere</title>
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    <link rel="stylesheet" href="{% static 'css/posts_list.css' %}">
</head>
<body>
<header>
    <h1><a href="{% url 'home' %}">ğŸš€ devSphere</a></h1>
</header>
<div class="page-wrapper">
    <div class="posts-container">
        <a href="{% url 'home' %}" class="back-link">â† Bosh sahifaga qaytish</a>
            <h1>
            <span>ğŸ“„ Mening Postlarim</span>
            <a href="{% url 'post_create' %}" class="btn-new">â• Yangi Post</a>
        </h1>

        {% if messages %}
            <ul class="messages">
                {% for message in messages %}
                    <li class="{{ message.tags }}">{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}

        {% if post_list %}
            {% for post in post_list %}
                <div class="post-item">
                    <div class="post-header">
                        <h3 class="post-title">
                            <a href="{% url 'post' post.slug %}">{{ post.title }}</a>
                        </h3>
                        <span class="post-status {% if post.is_active %}active{% else %}inactive{% endif %}">
                            {% if post.is_active %}âœ… Faol{% else %}â³ Ko'rib chiqilmoqda{% endif %}
                        </span>
                    </div>
                    <div class="post-meta">
                        <span><strong>ğŸ“‚ Kategoriya:</strong> {{ post.category.name }}</span>
                        <span><strong>ğŸ‘ï¸ Ko'rishlar:</strong> {{ post.views }}</span>
                        <span><strong>ğŸ’¬ Reaktsiyalar:</strong> {{ post.reactions.count }}</span>
                        <span><strong>ğŸ“… Yaratilgan:</strong> {{ post.created_at|date:"d.m.Y H:i" }}</span>
                    </div>
                    {% if post.tags.all %}
                        <div class="post-meta">
                            <strong>ğŸ·ï¸ Teglar:</strong>
                            {% for tag in post.tags.all %}
                                <span class="tag-badge">#{{ tag.name }}</span>
                            {% endfor %}
                        </div>
                    {% endif %}
                    <div class="post-actions">
                        <a href="{% url 'post' post.slug %}" class="action-btn btn-view">ğŸ‘ï¸ Ko'rish</a>
                        <a href="{% url 'post_edit' post.slug %}" class="action-btn btn-edit">âœï¸ Tahrirlash</a>
                        <a href="{% url 'post_delete' post.slug %}" class="action-btn btn-delete" 
                           onclick="return confirm('Haqiqatan ham bu postni o\'chirmoqchimisiz?')">ğŸ—‘ï¸ O'chirish</a>
                    </div>
                </div>
            {% endfor %}

            <div class="pagination">
                {% if page_obj.has_previous %}
                    <a href="{% if query_string %}?{{ query_string }}&page=1{% else %}?page=1{% endif %}" class="page-link">&laquo;</a>
                    <a href="{% if query_string %}?{{ query_string }}&page={{ page_obj.previous_page_number }}{% else %}?page={{ page_obj.previous_page_number }}{% endif %}" class="page-link">â€¹</a>
                {% endif %}

                {% for num in page_obj.paginator.page_range %}
                    {% if num == page_obj.number %}
                        <a href="{% if query_string %}?{{ query_string }}&page={{ num }}{% else %}?page={{ num }}{% endif %}" class="page-link active">{{ num }}</a>
                    {% elif num >= page_obj.number|add:-2 and num <= page_obj.number|add:2 %}
                        <a href="{% if query_string %}?{{ query_string }}&page={{ num }}{% else %}?page={{ num }}{% endif %}" class="page-link">{{ num }}</a>
                    {% elif num == 1 or num == page_obj.paginator.num_pages %}
                        <a href="{% if query_string %}?{{ query_string }}&page={{ num }}{% else %}?page={{ num }}{% endif %}" class="page-link">{{ num }}</a>
                    {% elif num == page_obj.number|add:-3 or num == page_obj.number|add:3 %}
                        <span class="dots">...</span>
                    {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                    <a href="{% if query_string %}?{{ query_string }}&page={{ page_obj.next_page_number }}{% else %}?page={{ page_obj.next_page_number }}{% endif %}" class="page-link">â€º</a>
                    <a href="{% if query_string %}?{{ query_string }}&page={{ page_obj.paginator.num_pages }}{% else %}?page={{ page_obj.paginator.num_pages }}{% endif %}" class="page-link">&raquo;</a>
                {% endif %}
            </div>
        {% else %}
            <div class="empty-message">
                <h2>ğŸ“ Hozircha postlar yo'q</h2>
                <p>Sizning postlaringiz bu yerda ko'rinadi</p>
                <a href="{% url 'post_create' %}" class="btn-new empty-action-btn">â• Birinchi postni yozish</a>
            </div>
        {% endif %}
    </div>
</div>
</body>
</html>
